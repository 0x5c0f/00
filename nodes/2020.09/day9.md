# OSI 七层模型 
OSI 模型是从上往下的，越底层越接近硬件，越往上越接近软件，这七层模型分别是物理层、数据链路层、网络层、传输层、会话层、表示层、应用层  
- 物理层: 在媒体上传输比特，提供机械的和电气的规约 
- 数据链路层: 将分组数据封装成帧，提供节点到节点方式的传输 
- 网络层: 将分组从源端传送到目的端，提供网络互联 
- 传输层: 提供可靠的端到端的报文传输和差错控制 
- 会话层: 建立、管理和终止会话 
- 表示层：对数据进行转换、加密和压缩 
- 应用层: 程序及接口 

|OSI七层模型|TCP/IP4层模型|功能|TCP/IP协议簇|
|-------|------------------|--------------------------|---------------------------|
|应用层|应用层|文件传输、邮件、文件共享、虚拟终端、web、域名服务|TFTP、HTTP、SMTP、DNS、TELNET|
|表示层|应用层|数据格式化、代码转化、数据加密|没有协议|
|会话层|应用层|解除或建立与别的节点的会话关系|没有协议|
|传输层|传输层|提供端对端的接口|TCP、UDP|
|网络层|网络层|为数据包选择路由(路由器)|IP、ICMP、RIP、OSPF、BGP、IGMP|
|数据链路层|链路层|传输有地址的帧及错误检测功能|SLIP、CSLIP、PPP、ARP、RARP、MTU(交换机)|
|物理层|链路层|以二进制数据形式在物理媒介上传输数据(光纤、普通网线、无线信号)|ISO2110、IEEE802、IEEE802.2|


## 一条消息如何发送到目标电脑上的 
1. 应用层录入消息`hello`(写信)
2. 传输层附加TCP包首部(装入信封)
3. 网络层附加IP包首部(写入地址和邮编)
    - IP数据包:首部(20字节:包含版本、首部长度、区分服务、总长度、标识、标志、片偏移、生存时间、协议、首部校验、源地址、目标地址、可选字段、填充、数据部分) + 数据(最大65515字节)
4. 数据链路层附加以太包首部(邮票和邮章)
    - 以太网协议: 一组电信号就是一个数据包，一个数据包又被称为一帧
    - 以太网包,包含目标mac、源mac地址
5. 物理层传通过光缆将数据输至目标(邮车转移) 
6. 数据链路层拆解以太包首部
7. 网络层拆解IP包首部 
8. 传输层拆解TCP包首部 
9. 应用层接收消息 

## 网络地址分类
**特殊B类地址网段: 169.254.0.0/16, 用于处理DHCP分配失败或没有DHCP服务的情况**  
### 共有地址
- A类: 1.0.0.0-126.0.0.0,默认子网掩码:255.0.0.0 ,第一个字节为网络号，后三个字节为主机号。该类ip地址的最前面为0,所以地址的网络号取值于1-126之间。一般用于大型网络。 
- B类: 128.0.0.0-191.255.0.0,默认子网掩码:255.255.0.0，前两个字节未网络号，后两个字节为主机号，该类IP
地址的最前面为10,所以地址的网络号取值于128-191之间，一般用于中等规模网络。
- C类: 192.0.0.0-223.255.255.0,默认子网掩码: 255.255.255.0 ,前三个字节为网络号，最后一个字节为主机号，该类IP地址的最前面为110,所以地址的网络号取值于192-223之间，一般用于小型网络.
- D类: 是多播地址，该类IP地址的最前面为1110,所以地址的网络号取值于224-239之间，一般用于多路广播用户。
- E类: 是保留地址。该类IP地址的最前面为1111,所以地址的网络号取值于240-255之间。

### 私有地址
- A类: 10.0.0.0-10.255.255.255.255 
- B类: 172.16.0.0-172.31.255.255
- C类: 192.168.0.0-192.168.255.255 

## 子网掩码计算


# ifconfig 命令
- 网卡启动/关闭: `ifconfig eth0 up/down` 
- 添加附属ip： `ifconfig eth0:1 192.16.10.11 netmask 255.255.255.0 up # ifconfig eth0:1 192.16.10.11/24 up ` 
- 修改mac地址: `ifconfig eth0 hw ether xx:xx:xx:xx:xx:xx`(mac地址有特定格式) 

# route 命令 
从原主机到目标主机的转发过程就叫做路由   
- 静态路由：静态路由是在路由器中设置固定的路由表；除非网络管理员进行干预，否则静态路由表不会发生变化。
- 动态路由：由网络中的路由器之间相互通信，传递路由信息，利用收到的路由信息更新路由表的路由方式。

参数详解:  
`Destination`: 目标网段或者主机    
`Gateway`: 网关地址,网络通过该IP出口，*或者 0.0.0.0代表是由本地转发出去的   
`Genmask`: 子网掩码   
`Flags`: 标记(U: 路由是活动的/运行状态，G： 路由指向的是一个网关,H: 目标是一个主机,!：路由已被禁止)   
`Metric`: 路由距离，到达指定网络所需的中转数（linux 内核中没有使用）  
`Ref`: 路由项引用次数（linux 内核中没有使用）  
`Use`: 此路由项被路由软件查找的次数  
`Iface`:该路由表项对应的输出接口  

临时添加方法:  
- 删除默认路由: `route del default (gw 192.16.10.1)` 
- 添加默认路由: `route add default gw 192.16.10.1` 
- 添加路由: `route add -host 192.16.101.0 netmask 255.255.255.0 gw 192.16.10.1` # 发往`192.16.101`网段的全部需要经过`192.16.10.1`
- 删除路由: `route del -host 192.16.101.0 netmask 255.255.255.0`

永久添加方法:  
- 将路由命令写入`/etc/rc.local`中  
- 在`/etc/sysconfig/`下创建默认脚本 

# ip 命令 
- 网卡启动/关闭: `ip link set eth0 up/down` 
- 修改网卡mac: `ip link set eth0 address xx:xx:xx:xx:xx:xx`
- 添加/删除附属ip： `ip address add/del 192.16.10.11/24 dev eth0`
- 添加/删除附属ip(别名): `ip address add/del 192.16.10.12/24 dev eth0 label eth0:1`  

